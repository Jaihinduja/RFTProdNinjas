<!DOCTYPE html>
<html>
<head>
    <title>Gemini Voice Chat</title>
    <style>
        body { font-family: Arial; padding: 40px; background: #f7f9fc; }
        textarea { width: 100%; height: 100px; }
        button { margin: 10px 5px; padding: 10px 20px; }
        .response { margin-top: 20px; background: #fff; padding: 20px; border-left: 4px solid #4CAF50; white-space: pre-wrap; }
    </style>
</head>
<body>
<h1>Gemini AI Voice Chat</h1>

<textarea id="prompt" placeholder="Type or use mic..." required></textarea><br>
<button onclick="sendPrompt()">Send</button>
<button onclick="startListening()">ðŸŽ¤ Speak</button>
<button onclick="resetChat()">ðŸ”„ Reset</button>

<div class="response" id="responseBox"></div>

<script>
    function sendPrompt() {
        const prompt = document.getElementById("prompt").value;
        if (!prompt) return;

        fetch("/ask", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ prompt })
        })
            .then(res => res.json())
            .then(data => {
                document.getElementById("responseBox").innerText = data.response;
                speak(data.response);
            });
    }

    function resetChat() {
        fetch("/reset", { method: "POST" })
            .then(() => {
                document.getElementById("responseBox").innerText = "Chat memory reset.";
            });
    }

    function startListening() {
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = "en-US";
        recognition.start();

        recognition.onresult = function(event) {
            const transcript = event.results[0][0].transcript;
            document.getElementById("prompt").value = transcript;
            sendPrompt();
        };
    }

    function speak(text) {
        const synth = window.speechSynthesis;
        const utter = new SpeechSynthesisUtterance(text);
        synth.speak(utter);
    }
</script>
</body>
</html>